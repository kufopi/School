{% extends 'core/base.html' %}
{% load static %}

{% block title %}Class Teacher Dashboard{% endblock %}

{% block extra_css %}
<style>
    .action-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        color: white;
        border-radius: 12px;
        padding: 24px;
        text-align: center;
        transition: all 0.2s ease;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        min-height: 160px;
    }

    .action-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        color: white;
        text-decoration: none;
    }

    .action-card svg {
        width: 40px;
        height: 40px;
        margin-bottom: 12px;
        opacity: 0.95;
    }

    .action-card h3 {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 4px;
        color: white;
    }

    .action-card p {
        font-size: 22px;
        font-weight: 600;
        margin: 0;
        color: white;
    }

    .action-card .small-text {
        font-size: 13px;
        font-weight: 400;
        margin: 4px 0 0 0;
        color: rgba(255, 255, 255, 0.9);
    }

    .card-blue { background: linear-gradient(135deg, #3b82f6, #2563eb); }
    .card-green { background: linear-gradient(135deg, #10b981, #059669); }
    .card-purple { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
    .card-orange { background: linear-gradient(135deg, #f59e0b, #d97706); }
    .card-indigo { background: linear-gradient(135deg, #6366f1, #4f46e5); }

    .header {
        background: white;
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 24px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .header h1 {
        font-size: 28px;
        font-weight: 700;
        color: #1e293b;
        margin-bottom: 16px;
    }

    .student-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 24px;
    }

    .meta-item {
        display: flex;
        align-items: center;
        gap: 8px;
        color: #64748b;
        font-size: 14px;
    }

    .meta-item i {
        color: #3b82f6;
        font-size: 16px;
    }

    .meta-item strong {
        color: #1e293b;
        font-weight: 600;
    }

    .table th {
        background-color: #f8fafc;
        font-weight: 600;
        font-size: 13px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: #475569;
        padding: 12px;
    }

    .table td {
        vertical-align: middle;
        padding: 14px 12px;
    }

    .btn-sm {
        padding: 6px 12px;
        font-size: 13px;
        font-weight: 500;
        border-radius: 6px;
        transition: all 0.2s ease;
    }

    .btn-sm:hover {
        transform: translateY(-1px);
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    .back-link {
        display: inline-flex;
        align-items: center;
        color: #3b82f6;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.2s ease;
        margin-bottom: 20px;
    }

    .back-link:hover {
        color: #2563eb;
    }

    .card-header {
        background: linear-gradient(to right, #f8fafc, #ffffff);
        border-bottom: 2px solid #e2e8f0;
    }

    .dashboard-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 24px;
    }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="mb-6">
        <a href="{% url 'teacher_dashboard' %}" class="back-link">
            <i class="fas fa-arrow-left"></i>
            Back to Teacher Dashboard
        </a>
    </div>

    <div class="header">
        <h1>Class Teacher Dashboard</h1>
        <div class="student-meta">
            <div class="meta-item">
                <i class="fas fa-chalkboard"></i>
                <span>Class: <strong>{{ class_teacher_assignment.class_assigned }}</strong></span>
            </div>
            <div class="meta-item">
                <i class="fas fa-calendar-alt"></i>
                <span>Session: <strong>{{ class_teacher_assignment.academic_session }}</strong></span>
            </div>
            <div class="meta-item">
                <i class="fas fa-clock"></i>
                <span>Term: <strong>{{ current_term }}</strong></span>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row g-4 mb-6">
        <div class="col-md-6 col-lg-3">
            <a href="{% url 'bulk_attendance_entry' %}" class="action-card card-blue">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                </svg>
                <h3>Bulk Attendance</h3>
                <p class="small-text">Mark attendance for all students</p>
            </a>
        </div>

        <div class="col-md-6 col-lg-3">
            <div class="action-card card-green" style="cursor: default;">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                </svg>
                <h3>Total Students</h3>
                <p>{{ students.count }}</p>
            </div>
        </div>

        <div class="col-md-6 col-lg-3">
            <div class="action-card card-purple" style="cursor: default;">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <h3>Manage Records</h3>
                <p class="small-text">Health & Behavior</p>
            </div>
        </div>

        <div class="col-md-6 col-lg-3">
            <a href="#" class="action-card card-indigo" onclick="event.preventDefault(); alert('Use the Comment button for each student to add term comments.');">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                </svg>
                <h3>Term Comments</h3>
                <p class="small-text">Add performance comments</p>
            </a>
        </div>
    </div>

    <!-- Student List -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title mb-0">
                <div class="card-icon">
                    <i class="fas fa-users"></i>
                </div>
                Student Records Management
            </h2>
        </div>
        
        {% if students %}
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead>
                    <tr>
                        <th>S/N</th>
                        <th>Student ID</th>
                        <th>Name</th>
                        <th>Gender</th>
                        <th class="text-center">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for student in students %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td><span class="text-muted">{{ student.student_id }}</span></td>
                        <td class="font-weight-bold">{{ student.user.get_full_name }}</td>
                        <td>{{ student.get_gender_display }}</td>
                        <td>
                            <div class="d-flex justify-content-center gap-2">
                                <a href="{% url 'enter_health_records' student.id %}" 
                                   class="btn btn-sm btn-primary"
                                   title="Health Records">
                                    <i class="fas fa-heartbeat me-1"></i> Health
                                </a>
                                <a href="{% url 'enter_behavior_assessment' student.id %}" 
                                   class="btn btn-sm btn-secondary"
                                   title="Behavior Assessment">
                                    <i class="fas fa-user-check me-1"></i> Behavior
                                </a>
                                <a href="{% url 'enter_attendance' student.id %}" 
                                   class="btn btn-sm btn-success"
                                   title="Attendance">
                                    <i class="fas fa-calendar-check me-1"></i> Attendance
                                </a>
                                <a href="{% url 'enter_term_comment' student.id %}" 
                                   class="btn btn-sm btn-info"
                                   title="Term Comment">
                                    <i class="fas fa-comment me-1"></i> Comment
                                </a>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="no-data">
            <i class="fas fa-users"></i>
            <p>No students found in this class.</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}